<h1>Accounts</h1>

<% if @sub_accounts.empty? %>
  <div class="alert alert-info">
    <i class="fas fa-info-circle me-2"></i>No SubAccounts added yet.
  </div>
<% end %>

<p>
  <strong>Available Percentage:</strong> <%= @main_account.available_percentage %>%</p>

<% if @main_account.owner == current_user && @main_account.available_percentage > 0 %>
  <%= link_to "New SubAccount", new_main_account_sub_account_path(@main_account), class: "btn btn-success mb-3" %>
<% elsif @main_account.owner == current_user %>
  <button class="btn btn-success mb-3" disabled>New SubAccount (Insufficient Available %)</button>
<% end %>

<% if @sub_accounts.any? %>
  <table class="table table-striped">
    <thead>
      <tr>
        <th>Title</th>
        <th>Percentage</th>
        <th>Balance</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% @sub_accounts.each do |sub_account| %>
        <tr>
          <td>
            <%= link_to sub_account.title, main_account_sub_account_path(@main_account, sub_account), 
                        class: "fw-bold text-decoration-none" %>
          </td>
          <td><%= sub_account.percentage %>%</td>
          <td><%= number_to_currency(sub_account.balance, unit: "â‚¬") %></td>
          <td class="d-flex">
            <% if @main_account.owner == current_user %>
              <%= link_to "Edit", edit_main_account_sub_account_path(@main_account, sub_account), class: "btn btn-primary btn-sm me-2" %>
            <% end %>
            <%= link_to "Show Transactions", transactions_path(sub_account_id: sub_account.id), class: "btn btn-info btn-sm" %>
          </td>
        </tr>
      <% end %>
    </tbody>
  </table>
<% end %>
